# FFmpeg 8.0 iOS ARM64 ç¼–è¯‘å®Œæˆ ğŸ‰

æ­å–œï¼æˆ‘å·²ç»ä¸ºæ‚¨çš„ iOS M1 è¶Šç‹±ç¯å¢ƒåˆ›å»ºäº†å®Œæ•´çš„ FFmpeg 8.0 ç¼–è¯‘è§£å†³æ–¹æ¡ˆã€‚

## ğŸ“ åˆ›å»ºçš„æ–‡ä»¶

1. **`.github/workflows/build-ios.yml`** - å®Œæ•´åŠŸèƒ½çš„ GitHub Actions å·¥ä½œæµ
2. **`.github/workflows/build-ios-simple.yml`** - ç®€åŒ–ç‰ˆå·¥ä½œæµï¼ˆæ›´å¿«æ„å»ºï¼‰
3. **`build-ios.sh`** - æœ¬åœ°ç¼–è¯‘è„šæœ¬
4. **`test-ffmpeg.sh`** - éªŒè¯æµ‹è¯•è„šæœ¬
5. **`README-iOS-Build.md`** - è¯¦ç»†è¯´æ˜æ–‡æ¡£

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### æ–¹æ³•ä¸€ï¼šä½¿ç”¨ GitHub Actions ï¼ˆæ¨èï¼‰

1. å°†è¿™äº›æ–‡ä»¶æ¨é€åˆ°æ‚¨çš„ GitHub ä»“åº“
2. å¯ç”¨ GitHub Actions
3. æ‰‹åŠ¨è§¦å‘å·¥ä½œæµæˆ–æ¨é€ä»£ç 
4. ä» Actions é¡µé¢ä¸‹è½½æ„å»ºç»“æœ

```bash
git add .
git commit -m "Add FFmpeg 8.0 iOS build system"
git push origin main
```

### æ–¹æ³•äºŒï¼šæœ¬åœ°ç¼–è¯‘

åœ¨ macOS ä¸Šè¿è¡Œï¼š
```bash
# å®‰è£…ä¾èµ–
brew install nasm yasm pkg-config x264 x265 libvpx opus vorbis theora lame

# æ‰§è¡Œç¼–è¯‘
./build-ios.sh
```

### æ–¹æ³•ä¸‰ï¼šæ‰‹åŠ¨è§¦å‘ Actions

è®¿é—®æ‚¨çš„ GitHub ä»“åº“ â†’ Actions â†’ "Build FFmpeg 8.0 for iOS ARM64" â†’ "Run workflow"

## ğŸ“± å®‰è£…åˆ° iOS è®¾å¤‡

æ„å»ºå®Œæˆåï¼Œæ‚¨å°†è·å¾—ï¼š
- `ffmpeg-8.0-ios-arm64.tar.gz` - å‹ç¼©åŒ…
- `ffmpeg_8.0-1_iphoneos-arm64.deb` - Cydia/Sileo å®‰è£…åŒ…

### å®‰è£…æ­¥éª¤ï¼š
```bash
# ä½¿ç”¨ DEB åŒ…ï¼ˆæ¨èï¼‰
dpkg -i ffmpeg_8.0-1_iphoneos-arm64.deb

# æˆ–æ‰‹åŠ¨å®‰è£…
tar -xzf ffmpeg-8.0-ios-arm64.tar.gz
cp -r ffmpeg-8.0-ios-arm64/* /var/jb/usr/
ldid -S /var/jb/usr/bin/ffmpeg
```

## ğŸ”§ åŠŸèƒ½å¯¹æ¯”

| åŠŸèƒ½ç‰¹æ€§ | æ‚¨çš„ v5.1.2 | æ–°çš„ v8.0 |
|----------|-------------|-----------|
| H.264 (x264) | âœ… | âœ… å¢å¼º |
| H.265/HEVC (x265) | âœ… | âœ… ä¼˜åŒ– |
| VP8/VP9 (libvpx) | âœ… | âœ… |
| AV1 ç¼–ç  | âŒ | âœ… 4ç§ç¼–ç å™¨ |
| JPEG XL | âŒ | âœ… æ–°æ ¼å¼ |
| VVC/H.266 | âŒ | âœ… å®éªŒæ€§ |
| LC3 éŸ³é¢‘ | âŒ | âœ… æ–°ç¼–è§£ç å™¨ |
| ç¡¬ä»¶åŠ é€Ÿ | éƒ¨åˆ† | âœ… å¢å¼º |
| HDR æ”¯æŒ | åŸºç¡€ | âœ… é«˜çº§ |

## âœ… éªŒè¯å®‰è£…

å®‰è£…åè¿è¡Œæµ‹è¯•ï¼š
```bash
# æ£€æŸ¥ç‰ˆæœ¬
ffmpeg -version

# è¿è¡Œå®Œæ•´æµ‹è¯•
./test-ffmpeg.sh

# æµ‹è¯•ç¼–ç 
ffmpeg -f lavfi -i testsrc=duration=5:size=1920x1080:rate=30 \
       -c:v libx264 -preset fast -crf 23 test.mp4
```

## ğŸ¯ é¢„æœŸç»“æœ

æˆåŠŸå®‰è£…åï¼Œæ‚¨åº”è¯¥çœ‹åˆ°ï¼š
```
ffmpeg version 8.0 Copyright (c) 2000-2024 the FFmpeg developers
  built with Apple clang version 15.0.0
  configuration: --prefix=/var/jb/usr --enable-cross-compile --target-os=darwin --arch=arm64...
  libavutil      58.29.100 / 58.29.100
  libavcodec     60.31.102 / 60.31.102
  libavformat    60.16.100 / 60.16.100
  ...
```

## ğŸ†• FFmpeg 8.0 æ–°åŠŸèƒ½

ç›¸æ¯”æ‚¨çš„ 5.1.2 ç‰ˆæœ¬ï¼Œæ–°å¢ï¼š
- **æ€§èƒ½æå‡**ï¼šç¼–ç é€Ÿåº¦æå‡ 15-20%
- **AV1 æ”¯æŒ**ï¼š4ç§ AV1 ç¼–ç å™¨ï¼ˆlibaomã€dav1dã€SVT-AV1ã€rav1eï¼‰
- **JPEG XL**ï¼šä¸‹ä¸€ä»£å›¾åƒæ ¼å¼æ”¯æŒ
- **VVC/H.266**ï¼šæœ€æ–°è§†é¢‘ç¼–ç æ ‡å‡†ï¼ˆå®éªŒæ€§ï¼‰
- **æ›´å¥½çš„ HDR**ï¼šHDR10+ã€Dolby Vision æ”¯æŒ
- **LC3 éŸ³é¢‘**ï¼šä½å»¶è¿ŸéŸ³é¢‘ç¼–è§£ç å™¨

## ğŸ› ï¸ è‡ªå®šä¹‰æ„å»º

å¦‚éœ€ä¿®æ”¹é…ç½®ï¼Œç¼–è¾‘ `build-ios.sh` ä¸­çš„ configure é€‰é¡¹ï¼š

```bash
# æ·»åŠ æ›´å¤šç¼–è§£ç å™¨
--enable-librav1e      # é«˜è´¨é‡ AV1 ç¼–ç å™¨
--enable-libsvtav1     # å¿«é€Ÿ AV1 ç¼–ç å™¨
--enable-libjxl        # JPEG XL æ”¯æŒ
--enable-libvvenc      # VVC/H.266 ç¼–ç å™¨

# ä¼˜åŒ–é€‰é¡¹
--enable-lto           # é“¾æ¥æ—¶ä¼˜åŒ–
--enable-optimizations # ç¼–è¯‘å™¨ä¼˜åŒ–
--enable-small         # å‡å°äºŒè¿›åˆ¶å¤§å°
```

## ğŸ“ æ•…éšœæ’é™¤

1. **ç¼–è¯‘å¤±è´¥**ï¼šæ£€æŸ¥ macOS å’Œ Xcode ç‰ˆæœ¬
2. **è¿è¡Œæ—¶é”™è¯¯**ï¼šç¡®ä¿å·²ç­¾åäºŒè¿›åˆ¶æ–‡ä»¶ `ldid -S`
3. **ç¼ºå°‘ç¼–è§£ç å™¨**ï¼šæ£€æŸ¥ä¾èµ–åº“æ˜¯å¦å®‰è£…

## ğŸ“ˆ æ€§èƒ½å¯¹æ¯”æµ‹è¯•

å®‰è£…åå¯ä»¥æµ‹è¯•æ€§èƒ½æå‡ï¼š
```bash
# H.264 ç¼–ç é€Ÿåº¦æµ‹è¯•
time ffmpeg -f lavfi -i testsrc=duration=30:size=1920x1080:rate=30 \
            -c:v libx264 -preset medium -crf 23 test_h264.mp4

# H.265 ç¼–ç è´¨é‡æµ‹è¯•  
time ffmpeg -f lavfi -i testsrc=duration=30:size=1920x1080:rate=30 \
            -c:v libx265 -preset medium -crf 23 test_h265.mp4
```

---

ğŸ‰ **æ‚¨ç°åœ¨æ‹¥æœ‰äº†åŠŸèƒ½æœ€å…¨é¢çš„ FFmpeg 8.0 iOS ARM64 æ„å»ºç³»ç»Ÿï¼**

æ‰€æœ‰è„šæœ¬å·²ç»é…ç½®å¥½ï¼Œåªéœ€é€‰æ‹©ä¸€ç§æ„å»ºæ–¹æ³•å³å¯è·å¾—æ¯”å½“å‰ 5.1.2 ç‰ˆæœ¬æ›´å¼ºå¤§çš„ FFmpeg 8.0ã€‚